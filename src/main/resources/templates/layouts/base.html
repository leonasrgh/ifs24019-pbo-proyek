<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  lang="id"
>
  <head>
    <!-- Meta -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui"
    />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Icon -->
    <link rel="icon" th:href="@{/assets/images/logo.png}" type="image/x-icon" />

    <!-- Judul -->
    <title layout:title-pattern="$CONTENT_TITLE">
      ğŸ MyCookbook - Sistem Informasi Nutrisi Makanan
    </title>

    <!-- Styles -->
    <link
      rel="stylesheet"
      th:href="@{/assets/vendor/bootstrap-5.3.8-dist/css/bootstrap.min.css}"
    />

    <link
      rel="stylesheet"
      th:href="@{/assets/vendor/sweetalert2/dist/sweetalert2.min.css}"
    />

    <!-- Custom Styles untuk Nutrition App -->
    <style>
      /* Header Navbar */
      .navbar-nutrition {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      /* Card Hover Effects */
      .card {
        transition: transform 0.2s, box-shadow 0.2s;
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
      }

      /* Badge Category Styles */
      .badge {
        padding: 0.5rem 1rem;
        font-size: 0.875rem;
      }

      /* Food Card Image */
      .card-img-top {
        border-radius: 0.375rem 0.375rem 0 0;
      }

      /* Nutrition Stats */
      .nutrition-stat {
        padding: 1rem;
        border-radius: 0.5rem;
        background: #f8f9fa;
        text-align: center;
      }

      /* Footer */
      .footer-nutrition {
        background: #343a40;
        color: #fff;
        padding: 2rem 0;
        margin-top: 4rem;
      }

      /* Active nav link */
      .nav-link.active {
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 0.25rem;
      }
    </style>

    <!-- Slot untuk CSS tambahan -->
    <th:block layout:fragment="others-css"></th:block>
  </head>

  <body class="bg-light">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark navbar-nutrition sticky-top">
      <div class="container-fluid">
        <a class="navbar-brand fw-bold" th:href="@{/}">
          ğŸ MyCookbook
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link" th:href="@{/}" 
                 th:classappend="${currentPath == '/' or currentPath == '/home' ? 'active' : ''}">
                ğŸ  Dashboard
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" th:href="@{/foods}" 
                 th:classappend="${#strings.startsWith(currentPath, '/foods') and currentPath != '/foods/statistics' ? 'active' : ''}">
                ğŸ“‹ Daftar Makanan
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" th:href="@{/foods/statistics}" 
                 th:classappend="${currentPath == '/foods/statistics' ? 'active' : ''}">
                ğŸ“Š Statistik Nutrisi
              </a>
            </li>
          </ul>

          <!-- User Info & Logout -->
          <ul class="navbar-nav ms-auto" th:if="${auth}">
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="userDropdown"
                role="button"
                data-bs-toggle="dropdown"
              >
                ğŸ‘¤ <span th:text="${auth.name}">User</span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end">
                <li>
                  <a class="dropdown-item" href="#">
                    ğŸ“§ <span th:text="${auth.email}">email@example.com</span>
                  </a>
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a class="dropdown-item" th:href="@{/auth/logout}">
                    ğŸšª Logout
                  </a>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <div layout:fragment="content" class="container-fluid">
      <!-- Konten akan diisi oleh child templates -->
    </div>

    <!-- Footer -->
    <footer class="footer-nutrition text-center">
      <div class="container">
        <p class="mb-2">
          ğŸ <strong>MyCookbook</strong> - Sistem Informasi Nutrisi Makanan
        </p>
        <p class="small text-muted mb-0">
          Proyek Akhir PBO &copy; 2025 | IFS24019 | Dibuat dengan â¤ï¸ menggunakan Spring Boot
        </p>
      </div>
    </footer>

    <!-- Bootstrap -->
    <script
      th:src="@{/assets/vendor/bootstrap-5.3.8-dist/js/bootstrap.bundle.min.js}"
    ></script>

    <!-- SweetAlert2 -->
    <script
      th:src="@{/assets/vendor/sweetalert2/dist/sweetalert2.all.min.js}"
    ></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        /* Ambil pesan sukses dari thymeleaf */
        const successMessage = "[[${success}]]";
        if (successMessage && successMessage.length > 5) {
          Swal.fire({
            icon: "success",
            title: "âœ… Berhasil!",
            text: successMessage,
            showConfirmButton: true,
            confirmButtonColor: "#667eea",
            timer: 3000
          });
        }

        /* Ambil pesan error dari thymeleaf */
        const errorMessage = "[[${error}]]";
        if (errorMessage && errorMessage.length > 5) {
          Swal.fire({
            icon: "error",
            title: "âŒ Gagal!",
            text: errorMessage,
            showConfirmButton: true,
            confirmButtonColor: "#dc3545",
          });
        }
      });
    </script>

    <!-- Slot untuk JavaScript tambahan -->
    <th:block layout:fragment="others-js"></th:block>
  </body>
</html>